<div class="container">

<table style="width: 100%;"><tr>
<td>zPatterns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Find and display patterns of zeros/missing values in a data set
</h2>

<h3>Description</h3>

<p>This function summarises the patterns of zero and/or missing values in a data set and returns a vector of pattern numbers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">zPatterns(X, label = NULL, plot = TRUE,
             axis.labels = c("Component", "Pattern ID"),
             bar.ordered = as.character(c(FALSE,FALSE)),
             bar.colors = c("red3", "red3"), bar.labels = FALSE,
             show.means = FALSE, round.means = 2, cex.means = 1,
             type.means = c("cgm","am"),
             cell.colors = c("dodgerblue", "white"),
             cell.labels = c(label, paste("No", label)), cex.axis = 1.1,
             grid.color = "black", grid.lty = "dotted",
             legend = TRUE, suppress.print = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Data set (<code>matrix</code> or <code>data.frame</code> class).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Unique label (<code>numeric</code> or <code>character</code>) used to identify zeros/unobserved values in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical value indicating whether a graphical summary of the patterns is produced or not (default <code>plot=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.labels</code></td>
<td>
<p>Vector of axis labels for the table of patterns (format <code>c("x-axis","y-axis")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.ordered</code></td>
<td>
<p>Vector of logical values to order table of patterns according to frequencies by patterns, component or both; with the first element referring to the patterns and the second to the components (default <code>c(FALSE,FALSE)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.colors</code></td>
<td>
<p>Colors for the margin barplots (format <code>c("col.top","col.right")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.labels</code></td>
<td>
<p>Logical value indicating if labels showing percentages must be added to the margin barplots (default <code>bar.labels=FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.means</code></td>
<td>
<p>Logical value indicating if mean values by pattern are shown on the graphical summary table (default <code>show.means=FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round.means</code></td>
<td>
<p>When <code>show.means=TRUE</code>, number of decimal places for the mean values shown (2=default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.means</code></td>
<td>
<p>When <code>show.means=TRUE</code>, numeric character expansion factor; character size for the mean values shown (1=default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.means</code></td>
<td>
<p>When <code>show.means=TRUE</code>, statistic used for computing the means. Either compositional geometric mean (<code>type.means=cgm</code>, in percentage units, default) or standard arithmetic mean (<code>type.means=am</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.colors</code></td>
<td>
<p>Vector of colors for the table cells (format <code>c("col.unobserved","col.observed")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.labels</code></td>
<td>
<p>Labels for the cells (format <code>c("Unobserved","Observed")</code>, default <code>c(label,paste("No",label))</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Axis labels scaling factor relative to default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.color</code></td>
<td>
<p>Color of the grid lines (default <code>"black"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.lty</code></td>
<td>
<p>Style of the grid lines (default <code>"dotted"</code>, see <code>lty</code> in <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Logical value indicating if a legend must be included (default <code>legend=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.print</code></td>
<td>
<p>Suppress printed feedback (default <code>suppress.print=FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Vector (factor type) of pattern IDs corresponding to each row of <code>X</code>.
</p>
<p>By default, a summary table is printed showing patterns in the data according to <code>label</code> and some summary statistics: number of zero/missing components by pattern (No.Unobs), pattern frequency in percentage, percentage zero/missing values by component (column) and overall percentage of zero/missing values in the data set. The symbols + and - indicate, respectively, zero/missing and observed components within each pattern. A graphical version of the summary table is returned including barplots on the margins displaying percentage zero/missing and compositional geometric means by pattern (if <code>show.means=TRUE</code>; expressed in percentage scale). Common arithmetic means can be also shown for the case of ordinary data (<code>type.means="am"</code>), however this is not recommended for compositional data.
</p>
<p>The patterns are assigned ID number and by default arranged in the table in the same order as they are found in the data set. The argument <code>bar.ordered</code> can be used to re-arrange the display according to frequencies of patterns, of unobserved values by component or both.
</p>
<p>A warning message is shown if zeros or NA values not identified by <code>label</code> are present in the data set. These will be ignored for the graphical display and numerical summaries of patterns, which will be only based on <code>label</code>.
</p>
<p>Check out 'plus' functions to deal with zeros and missing data simultaneously.
</p>


<h3>References</h3>

<p>Palarea-Albaladejo J. and Martin-Fernandez JA. zCompositions â€“ R package for multivariate imputation of
left-censored data under a compositional approach. Chemometrics and Intelligence Laboratory Systems 2015; 143: 85-96.
</p>


<h3>See Also</h3>

<p><code>lrEM</code>, <code>lrEMplus</code>, <code>lrDA</code>, <code>multRepl</code>, <code>multReplus</code>, <code>multLN</code>, <code>multKM</code>, <code>cmultRepl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(LPdata)

pattern.ID &lt;- zPatterns(LPdata,label=0)

LPdata[pattern.ID==5,]
LPdata[pattern.ID==7,]
LPdata[pattern.ID==10,]

# Modify cell labels and show percentages along with barplots
pattern.ID &lt;- zPatterns(LPdata,label=0,
              cell.labels=c("Zero","Non-zero"),bar.labels=TRUE)

# Show compositional geometric means (in %) per zero pattern
zPatterns(LPdata,label=0,show.means=TRUE)

# Same but orderer by pattern frequency and incidence of zeros by component
zPatterns(LPdata,label=0,bar.ordered=c(TRUE,TRUE),,bar.labels=TRUE,show.means=TRUE)

# Data set with zeros and missing data (0 = zero; NA = missing) (see lrEMplus function).
data(LPdataZM)

# Show missingness patterns only
zPatterns(LPdataZM,label=NA)

# Show zero patterns only and means by pattern based on available data
# (blanks indicate not enough data available for computation)
zPatterns(LPdataZM,label=0,show.means=TRUE)
</code></pre>


</div>