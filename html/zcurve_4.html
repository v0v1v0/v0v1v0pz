<div class="container">

<table style="width: 100%;"><tr>
<td>control_EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Control settings for the zcurve EM algorithm</h2>

<h3>Description</h3>

<p>All these settings are passed to the Expectation Maximization
fitting algorithm. All unspecified settings are set to the default value.
Setting <code>model = "EM"</code> sets all settings to the default
value irrespective of any other setting and fits z-curve as described in
Bartoš and Schimmack (2020)
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A type of model to be fitted, defaults to <code>"EM"</code>
for a z-curve with 7 z-scores centered components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_level</code></td>
<td>
<p>An alpha level of the test statistics, defaults to
<code>.05</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A beginning of fitting interval, defaults to
<code>qnorm(sig_level/2,lower.tail = F)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>An end of fitting interval, defaults to <code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Means of the components, defaults to
<code>0:6</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A standard deviation of the components, defaults to
<code>rep(1, length(mu))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_alpha</code></td>
<td>
<p>A vector of alpha parameters of a Dirichlet distribution
for generating random starting values for the weights, defaults to
<code>rep(.5, length(mu))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_max</code></td>
<td>
<p>Upper limits for weights, defaults to
<code>rep(1,length(mu))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A criterion to terminate the EM algorithm,
defaults to <code>1e-6</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion_start</code></td>
<td>
<p>A criterion to terminate the starting phase
of the EM algorithm, defaults to <code>1e-3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion_boot</code></td>
<td>
<p>A criterion to terminate the bootstrapping phase
of the EM algorithm, defaults to <code>1e-5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>A maximum number of iterations of the EM algorithm
(not including the starting iterations) defaults to <code>10000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_start</code></td>
<td>
<p>A maximum number of iterations for the
starting phase of EM algorithm, defaults to <code>100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_boot</code></td>
<td>
<p>A maximum number of iterations for the
booting phase of EM algorithm, defaults to <code>100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_reps</code></td>
<td>
<p>A number of starting fits to get the initial
position for the EM algorithm, defaults to <code>100</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bartoš F, Schimmack U (2020).
“Z-curve. 2.0: Estimating Replication Rates and Discovery Rates.”
<a href="https://doi.org/10.31219/osf.io/wr93f">doi:10.31219/osf.io/wr93f</a>, submitted for publication.
</p>


<h3>See Also</h3>

<p><code>zcurve()</code>, control_density
</p>


<h3>Examples</h3>

<pre><code class="language-R"># to increase the number of starting fits
# and change the means of the mixture components

ctrl &lt;- list(
   fit_reps  = 50,
   mu = c(0, 1.5, 3, 4.5, 6)
)
## Not run: zcurve(OSC.z, method = "EM", control = ctrl)

</code></pre>


</div>