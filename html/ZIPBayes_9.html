<div class="container">

<table style="width: 100%;"><tr>
<td>ZIPInt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Zero-inflated Poisson model under measurement error and internal validation data are available
</h2>

<h3>Description</h3>

<p>The function implements the MCMC algorithm with data augmentation to estimate the parameters in the zero-inflated Poisson model while correcting for the measurement error arising from the responses. The function returns the trace of the sampled parameters in each interaction. To obtain the summary estimation, use <code>summary</code>().
</p>


<h3>Usage</h3>

<pre><code class="language-R">ZIPInt (Ystar, Covarmainphi, Covarmainmu, Covarplus, Covarminus,
       Ystarval, Yval, Covarvalmainphi, Covarvalmainmu, Covarvalplus, Covarvalminus,
       betaphi, betamu, alphaplus, alphaminus,
       Uibound = c(7,11),
       priorgamma, priormu, priorSigma, 
       propsigmaphi,  propsigmamu = propsigmaphi, 
            propsigmaplus = propsigmaphi,  propsigmaminus = propsigmaphi,
       seed = 1, nmcmc = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ystar</code></td>
<td>

<p>a count vector of length <code class="reqn">n</code> specifying the error-prone response in the zero-inflated Poisson model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarmainphi</code></td>
<td>

<p>a <code class="reqn">n \times p_1</code> dimensional data.frame or matrix of the covariate data with respect to the probability component of the zero-inflated Poisson model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarmainmu</code></td>
<td>

<p>a <code class="reqn">n \times p_2</code> dimensional data.frame or matrix of the covariate data with respect to the mean component of the zero-inflated Poisson model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarplus</code></td>
<td>

<p>a <code class="reqn">n \times q_1</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the add-in error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarminus</code></td>
<td>

<p>a <code class="reqn">n \times q_2</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the leave-out error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ystarval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the  error-prone response in the validation data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the precisely measured response in the validation data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarvalmainphi</code></td>
<td>

<p>a <code class="reqn">m \times p_1</code> dimensional data.frame or matrix of the covariate for validation data with respect to the probability component of ZIP model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarvalmainmu</code></td>
<td>

<p>a <code class="reqn">m \times p_2</code> dimensional data.frame or matrix of the covariate for validation data with respect to the mean component of ZIP model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarvalplus</code></td>
<td>

<p>a <code class="reqn">m \times q_1</code> dimensional data.frame or matrix of the covariate for validation data of the add-in error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covarvalminus</code></td>
<td>

<p>a <code class="reqn">m \times q_2</code> dimensional data.frame or matrix of the covariate  for validation data of the leave-out error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the initial values of the parameters for the measurement error model of the add-in error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the initial values of the parameters in the probability component of the leave-out error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uibound</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the maximum number of the count in the inverse sampling method
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorgamma</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the two parameters of gamma prior
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priormu</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the mean vector of the normal prior for the measurement error model of the leave-out error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorSigma</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the standard erros of the normal prior for the measurement error model of the leave-out error process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propsigmaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the probability component. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propsigmamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the mean component. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propsigmaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the add-in error process. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propsigmaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the leave-out error process. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>a numeric value specifying the seed for random generator
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmcmc</code></td>
<td>

<p>a integer specify the number of the generation of MCMC algorithm
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Comparing to the ZIPExt function for the external validation study, this function has an addition component – covariates of response model in the validation data. Here, the argument “Covarvalmainphi” and “Covarvalmainmu” are new for the sceanrio with external validation.  
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>BayesResults</code></td>
<td>
<p>the list of trace of generated parameters for each component of the models. Data frame "betaphi_trace" corresponds to the probability component of ZIP response model; "betamu_trace" refers to the mean component of the ZIP response model. Data frames "alphaplus_trace" and "alphaminus_trace", respectively, correspond to the add-in error and leave-out error process in the measruement error model.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi
</p>


<h3>References</h3>

<p>Zhang, Qihuang. "Inference Methods for Noisy Correlated Responses with Measurement Error." (2020).</p>


<h3>See Also</h3>

<p><code>glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(datasimInt)
set.seed(0)
result &lt;-  ZIPInt(Ystar = datasimInt$main$Ystar,
                  Covarmainphi = datasimInt$main[,c("intercept","X1")],
                  Covarmainmu = datasimInt$main[,c("intercept","X2")],
                  Covarplus = datasimInt$main[,c("intercept", "Zplus")],
                  Covarminus = datasimInt$main[,c("intercept", "Zminus")],
                  Ystarval = datasimInt$val$Ystar,
                  Yval = datasimInt$val$Y,
                  Covarvalmainphi = datasimInt$val[,c("intercept","X1")],
                  Covarvalmainmu = datasimInt$val[,c("intercept","X2")],
                  Covarvalplus = datasimInt$val[,c("intercept", "Zplus")],
                  Covarvalminus = datasimInt$val[,c("intercept", "Zminus")],
                  betamu =  c(-0.5,0.5), betaphi = c(0.5,0),
                  alphaplus = c(0,0), alphaminus= c(0,0),
                  priorgamma = c(1,1), priormu = c(0,0), priorSigma = c(1,1), 
                     propsigmaphi = c(0.05,0.05), nmcmc = 10)
                     
summary(result)
</code></pre>


</div>